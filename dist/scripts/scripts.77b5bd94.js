"use strict";var app=angular.module("sacoForaldraforsakringApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ui.bootstrap","ui.bootstrap-slider","angular-toArrayFilter"]);angular.module("sacoForaldraforsakringApp").controller("MainCtrl",["$scope","$modal",function(a,b){function c(a,b){return.99*b>a?.423*b:2.72*b>a?.225*b+.2*a:3.11*b>a?.77*b:7.88*b>a?1.081*b-.1*a:.293*b}function d(a){var b=c(a,j);return(a-b)*k+Math.max(0,.2*(a-b-l))+Math.max(0,.05*(a-b-m))}function e(a,b,d){var e=c(a,d);return.91*d>a?(a-e)*b:2.94*d>a?(.91*d+.332*(a-.91*d)-e)*b:8.08*d>a?(1.584*d+.111*(a-2.94*d)-e)*b:13.48*d>a?(2.155*d-e)*b:Math.max(0,2.155*d-e)*b-.03*(a-13.84*d)}function f(a,b){var c=12*a,d=10*b;return c>d?.776*(10*b/365)*30:.8*c*.97/365*30}function g(a,b){var c=12*a,d=10*b;return c>d?a-240*b/365-3*c/365:a-27*c/365}function h(a,b,c){var d=Math.min(a,12-a)-c;return 30*Math.max(d,0)*b}function i(){var b=a.parents[0].input.lonManad,c=a.parents[1].input.lonManad,d=a.parents[0].input.ledigaManader,e=a.parents[1].input.ledigaManader,f=a.parents[0].input.foraldralonManader,g=a.parents[1].input.foraldralonManader;a.parents[0].inkomstSpec=q(b,d,f),a.parents[1].inkomstSpec=q(c,e,g)}a.parents=[{input:{lonManad:25e3,ledigaManader:6,foraldralonManader:6}},{input:{lonManad:5e4,foraldralonManader:6}}],a.$watch("parents[0].input.ledigaManader",function(b,c){a.parents[1].input.ledigaManader=12-b}),a.settings={hetero:!0},a.$watch("settings.hetero",function(b){b?(a.parents[0].label="mamman",a.parents[1].label="pappan"):(a.parents[0].label="förälder ett",a.parents[1].label="förälder två")}),a.modal=function(a){b.open({templateUrl:"templates/modal-info.html",controller:"ModalInstanceCtrl",size:"sm",resolve:{data:function(){return{msg:a}}}})};var j=44500,k=.3199,l=421800,m=616100,n=50,o=4,p=1050;a.$watch("parents[0].input",i,!0),a.$watch("parents[1].input",i,!0);var q=function(a,b,c){var i=a,l=12-b,m=f(i,j),q=g(i,j),r=Math.min(c,b),s=d(i),t=e(i,k,j),u=s/i,v=(s-t)/i,w=h(b,n,o),x={lonBrutto:{label:"Bruttolön",value:i*l,type:"brutto",order:1},lonNetto:{label:"Nettolön",value:(i-s-t)*l,type:"netto",order:2},FPbrutto:{label:"Föräldrapenning före skatt",value:m*b,type:"brutto",order:3},FPnetto:{label:"Föräldrapenning efter skatt",value:(m-m*u)*b,type:"netto",order:4},skatteprocentUtanJSA:{label:"Skatteprocent utan JSA",value:100*u,order:2.5},FLbrutto:{label:"Föräldralön före skatt",value:q*r,type:"brutto",order:5},FLnetto:{label:"Föräldralön efter skatt",value:(q-q*v)*r,type:"netto",order:6},skatteprocentMedJSA:{label:"Skatteprocent med JSA",value:100*v,order:2.5},JB:{label:"Jämställdhetsbonus",value:w,type:"skattefri",order:7},BB:{label:"Barnbidrag",value:p/2*12,type:"skattefri",order:8},totalBrutto:{label:"Total bruttoinkomst",type:"total",value:0,order:9},totalNetto:{label:"Total nettoinkomst",type:"total",value:0,order:10}};return angular.forEach(x,function(a,b){"netto"==a.type&&(x.totalNetto.value+=a.value),"brutto"==a.type&&(x.totalBrutto.value+=a.value),"skattefri"==a.type&&(x.totalNetto.value+=a.value,x.totalBrutto.value+=a.value)}),x}}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance","data",function(a,b,c){a.msg=c.msg,a.close=function(){b.close()}}]),app.directive("monthSlider",function(){return{restrict:"E",transclude:!1,templateUrl:"templates/slider.html"}});